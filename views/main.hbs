<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD Application</title>
    <link rel="stylesheet" href="./views/output.css">
</head>

<body class="justify-center items-center bg-cyan-600">

    
    <nav class="shadow-md fixed w-full z-20 top-0 left-0 border-gray-200 dark:border-gray-600 bg-cyan-700">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-center mx-auto p-4">
    
            <ul class="flex justify-between p-4 md:p-0 mt-4 font-medium rounded-lg md:flex-row md:space-x-8 md:mt-0 w-2/5">
                <li>
                    <a href="#" class="tracking-widest text-lg block py-1 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:p-0 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"><span>&lt;</span>Create<span>&gt;</span></a>
                </li>
                <li>
                    <a href="#" class="showModal tracking-widest text-lg block py-1 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:p-0 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"><span>&lt;</span>Update<span>&gt;</span></a>
                </li>
                <li>
                    <a href="#" class="showModal tracking-widest text-lg block py-1 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:p-0 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"><span>&lt;</span>Delete<span>&gt;</span></a>
                </li>
            </ul>
            
        </div>
    </nav>

    <br><br><br>
    <h1 class="my-4 text-xl font-bold leading-none md:text-4xl lg:text-5xl text-center tracking-wide text-white">
        CRUD APPLICATION
    </h1>

    <br>

    {{#if edit_id}}

    <h3 class="text-center mb-5 text-2xl tracking-wider text-white font-semibold"><-- Edit an Item --></h3><br>

    <div class="flex justify-center align-center">
        <form class="w-2/6 border-solid border-2 border-white py-4 px-2 h-auto rounded-lg shadow-2xl" method="post" action="/update_item/{{edit_id}}">
            <div class="md:flex md:items-center mb-6 mx-3 text-md flex-col py-2">
                <div class="md:w-11/12 mb-1">
                    <label class="block text-left text-white mb-1 md:mb-0 text-lg tracking-wider">
                        Name of the Item : 
                    </label>
                </div>
                <div class="md:w-11/12 mt-1">
                    <input class="shadow-xl bg-white appearance-none border-2 border-red-400 rounded w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500" type="text" name="title" value="{{edit_item.title}}">
                </div>
            </div>
            <div class="md:flex md:items-center mb-6 mx-3 text-md flex-col">
                <div class="md:w-11/12 mb-1">
                    <label class="block md:text-left text-white mb-1 md:mb-0 text-lg tracking-wider">
                        Description : 
                    </label>
                </div>
                <div class="md:w-11/12 mt-1">
                    <input class="shadow-xl bg-white appearance-none border-2 border-red-400 rounded w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500" type="text" name="description" value="{{edit_item.description}}">
                </div>
            </div>
            
            <div class="md:flex md:items-center flex justify-center">
                <div class="md:w-2/3 flex justify-center mb-1">
                    <button class="tracking-wider shadow-xl bg-yellow-500 text-white py-2 px-4 rounded border border-white" type="submit">
                        Submit
                    </button>
                </div>
            </div>
        </form>
    </div>

    {{else}}

    <h3 class="text-center mb-5 text-2xl tracking-wider text-white font-semibold"><-- Add an Item --></h3><br>

    <div class="flex justify-center align-center">
        <form class="w-2/6 border-solid border-2 border-white py-4 px-2 h-auto rounded-lg shadow-2xl" method="post" action="/store_item">
            <div class="md:flex md:items-center mb-6 mx-3 text-md flex-col py-2">
                <div class="md:w-11/12 mb-1">
                    <label class="block text-left text-white mb-1 md:mb-0 text-lg tracking-wider">
                        Name of the Item : 
                    </label>
                </div>
                <div class="w-11/12 mt-1">
                    <input class="shadow-xl bg-white appearance-none border-2 border-red-400 rounded w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500" type="text" name="title">
                </div>
            </div>
            <div class="md:flex md:items-center mb-6 mx-3 text-md flex-col">
                <div class="md:w-11/12 mb-1">
                    <label class="block md:text-left text-white mb-1 md:mb-0 text-lg tracking-wider">
                        Description : 
                    </label>
                </div>
                <div class="md:w-11/12 mt-1">
                    <input class="shadow-xl bg-white appearance-none border-2 border-red-400 rounded w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500" type="text" name="description">
                </div>
            </div>
            
            <div class="md:flex md:items-center flex justify-center">
                <div class="md:w-2/3 flex justify-center mb-1">
                    <button class="tracking-wider shadow-xl bg-purple-300 text-white py-2 px-4 rounded border border-white text-lg" type="submit">
                        Submit
                    </button>
                </div>
            </div>
        </form>
    </div>

    {{/if}}

    <br>
    <div class="flex justify-center mt-2">
        <h2 class="w-1/5 py-4 px-2 text-xl text-center tracking-wider drop-shadow-xl text-white animate-bounce">{{message}}</h2>
    </div>

    <div class="modal h-screen w-full fixed left-0 top-0 flex justify-center items-center bg-black bg-opacity-50 hidden">
        <div class="bg-white rounded shadow-lg h-3/4 w-1/3">

            <div class="border-b px-4 py-2 flex justify-between items-center">
                <h3 class="font-semibold text-lg">List of Items</h3>
                <button class="text-black closeModal">&cross;</button>
            </div>

            <div class="p-3">
                
                <table class="border-2 border-cyan-200 border-collapse w-full">
                    <thead class="text-white tracking-wider">
                        <tr class="flex w-full">
                            <th class="py-3 bg-cyan-800 w-1/4">Name</th>
                            <th class="py-3 bg-cyan-800 w-1/4">Author</th>
                            <th class="py-3 bg-cyan-800 w-1/4">Update</th>
                            <th class="py-3 bg-cyan-800 w-1/4">Delete</th>
                        </tr>
                    </thead>
                    <tbody class="text-cyan-900 text-center flex flex-col items-center overflow-y-scroll" style="height: 50vh;">
                        {{#each items}}
                            <tr class="bg-cyan-200 flex w-full">
                                <td class="py-3 px-6 w-1/4">{{this.title}}</td>
                                <td class="py-3 px-6 w-1/4">{{this.description}}</td>
                                <td class="py-3 px-6 w-1/4 cursor-pointer"><a href="/?edit_id={{this._id}}">Edit</a></td>
                                <td class="py-3 px-6 w-1/4 cursor-pointer"><a href="/?delete_id={{this._id}}" onclick="return confirm('Are you sure want to delete?')">Delete</a></td>
                            </tr>
                        {{/each}}
                    </tbody>
                </table>  

                <div class="flex justify-end items-center w-100 border-t p-3">
                    <button class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-white closeModal">OK</button>
                </div>
            </div>

        </div>
    </div>

    {{!-- Tailwind css for modal --}}
    <script>
        const modal = document.querySelector('.modal');
        const showModal = document.querySelectorAll('.showModal');
        const closeModal = document.querySelectorAll('.closeModal');

        showModal.forEach(function(button) {
            button.addEventListener('click', function() {
                modal.classList.remove('hidden');
            });
        });


        closeModal.forEach(close =>{
            close.addEventListener('click', function(){
                modal.classList.add('hidden')
            });
        });

    </script>

</body>
</html>